<!-- Key Statistics with Animation -->
<div class="stats-grid">
    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-trending-up"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                <span class="counter" data-target="{{ demand_stats.historical.quantity|default:0|floatformat:'0' }}">0</span> L
            </div>
            <div class="stat-label">Demanda Inicial</div>
            <div class="stat-description">Promedio histórico</div>
        </div>
    </div>

    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-target-lock"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                <span class="counter" data-target="{{ demand_predicted.quantity|default:0|floatformat:'0' }}">0</span> L
            </div>
            <div class="stat-label">Demanda Predicha</div>
            <div class="stat-description">Proyección del modelo</div>
        </div>
    </div>

    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-line-chart"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                <span class="counter" data-target="{{ growth_rate|default_if_none:0|default:0|floatformat:'2' }}">0</span>%
            </div>
            <div class="stat-label">Tasa de Crecimiento</div>
            <div class="stat-description">Crecimiento estimado</div>
        </div>
    </div>

    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-error-circle"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                <span class="counter" data-target="{{ error_permisible|default_if_none:0|default:0|floatformat:'2' }}">0</span>%
            </div>
            <div class="stat-label">Error Permisible</div>
            <div class="stat-description">Margen de tolerancia</div>
        </div>
    </div>

    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-calendar"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                <span class="counter" data-target="{{ simulation_instance.quantity_time|default:0 }}">0</span>
            </div>
            <div class="stat-label">Días Simulados</div>
            <div class="stat-description">Período de análisis</div>
        </div>
    </div>

    <!-- Métricas adicionales -->
    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-dollar-circle"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                {% if totales_acumulativos.GT %}
                    <span class="counter" data-target="{{ totales_acumulativos.GT.total|floatformat:'0' }}">0</span>
                {% else %}
                    <span class="counter" data-target="0">0</span>
                {% endif %}
                Bs.
            </div>
            <div class="stat-label">Ganancia Total</div>
            <div class="stat-description">Beneficio acumulado</div>
        </div>
    </div>

    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-package"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                {% if totales_acumulativos.TPV %}
                    <span class="counter" data-target="{{ totales_acumulativos.TPV.total|floatformat:'0' }}">0</span>
                {% else %}
                    <span class="counter" data-target="0">0</span>
                {% endif %}
                L
            </div>
            <div class="stat-label">Productos Vendidos</div>
            <div class="stat-description">Total del período</div>
        </div>
    </div>

    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-tachometer"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                {% if totales_acumulativos.EOG and all_variables_extracted|length > 0 %}
                    {% widthratio totales_acumulativos.EOG.total 1 all_variables_extracted|length as avg_eog %}
                    {% widthratio avg_eog 1 100 as eog_percent %}
                    <span class="counter" data-target="{{ eog_percent|floatformat:'1' }}">0</span>%
                {% else %}
                    <span class="counter" data-target="0">0</span>%
                {% endif %}
            </div>
            <div class="stat-label">Eficiencia Operativa</div>
            <div class="stat-description">Promedio del período</div>
        </div>
    </div>

    <div class="stat-item">
        <div class="stat-icon">
            <i class="bx bx-percentage"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                {% if totales_acumulativos.NR and all_variables_extracted|length > 0 %}
                    {% widthratio totales_acumulativos.NR.total 1 all_variables_extracted|length as avg_margin %}
                    {% widthratio avg_margin 1 100 as margin_percent %}
                    <span class="counter" data-target="{{ margin_percent|floatformat:'1' }}">0</span>%
                {% else %}
                    <span class="counter" data-target="0">0</span>%
                {% endif %}
            </div>
            <div class="stat-label">Rentabilidad</div>
            <div class="stat-description">Margen promedio</div>
        </div>
    </div>
</div>